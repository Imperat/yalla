"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function render(e,t){if(t.$content)_render(e,t.$content);else{var n=document.createComment(PLACEHOLDER_CONTENT);t.appendChild(n),_render(e,n),t.$content=n}}function destroy(e){e instanceof HtmlTemplate?e.destroy():e instanceof HtmlTemplateCollection?e.destroy():e.parentNode&&e.parentNode.removeChild(e)}function _render(e,t){e instanceof HtmlTemplate?_renderHtmlTemplate(e,t):e instanceof HtmlTemplateCollection?_renderHtmlTemplateCollection(e,t):_renderText(e,t)}function getFirstNodeFromTemplate(e,t){return e instanceof HtmlTemplate?e.nodeTree[0]:e instanceof HtmlTemplateCollection?getFirstNodeFromTemplate(e.htmlTemplates[e.keys[0]],t):t.$content}function _renderHtmlTemplateCollection(e,t){var n={},o={},r=[],a=t.$content;!a||a instanceof HtmlTemplateCollection||(destroy(a),a=null),a&&(r=a.keys,o=a.placeHolders),r.forEach(function(t){if(e.keys.indexOf(t)<0){removePlaceholder(o[t])}}),e.keys.reduceRight(function(r,i,l,c){var s=e.htmlTemplates[i],u=document.createComment(PLACEHOLDER_CONTENT);if(o[i]&&(u=o[i]),u.nextSibling?u.nextSibling!=r&&t.parentNode.insertBefore(u,r):t.parentNode.insertBefore(u,r),n[i]=u,o[i]){var d=a.htmlTemplates[i];_render(s,u),d instanceof HtmlTemplate&&s instanceof HtmlTemplate&&d.key==s.key&&(e.htmlTemplates[i]=d)}else _render(s,u);return getFirstNodeFromTemplate(e.htmlTemplates[i],u)},t),e.placeHolders=n,t.$content=e}function removePlaceholder(e){e.$content instanceof HtmlTemplate?e.$content.nodeTree.forEach(function(e){return e.parentNode.removeChild(e)}):Array.isArray(e.$content)&&e.$content.forEach(function(e){return removePlaceholder(e)}),e.parentNode.removeChild(e)}function _renderHtmlTemplate(e,t){t.$content?t.$content instanceof HtmlTemplate?(t.$content.applyValues(e.values),t.$content.nodeTree.reduceRight(function(e,t,n){return t.nextSibling&&t.nextSibling!=e&&e.parentNode&&e.parentNode.insertBefore(t,e),t},t)):(destroy(t.$content),e.generateNodeTree().forEach(function(e){return t.parentNode.insertBefore(e,t)}),t.$content=e):(e.generateNodeTree().forEach(function(e){return t.parentNode.insertBefore(e,t)}),t.$content=e)}function _renderText(e,t){if(null!=t.parentNode){t.$content&&destroy(t.$content);var n=document.createTextNode(e);t.parentNode.insertBefore(n,t),t.$content=n}}function html(e){for(var t=arguments.length,n=Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return new HtmlTemplate(e,n)}function htmlMap(e,t,n){return new HtmlTemplateCollection(e,t,n)}function getPath(e){for(var t=0,n=e;null!=(n=n.previousSibling);)t++;var o=[];return o.push(t),e.parentNode&&e.parentNode.nodeType!=Node.DOCUMENT_FRAGMENT_NODE?o.concat(getPath(e.parentNode)):o}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),PLACEHOLDER_CONTENT="âˆž",PLACEHOLDER="\x3c!--"+PLACEHOLDER_CONTENT+"--\x3e",isMinimizationAttribute=function(e){return["checked","compact","declare","defer","disabled","ismap","noresize","noshade","nowrap","selected"].indexOf(e.nodeName)>=0},_cache={},HtmlTemplateCollection=function(){function e(t,n,o){_classCallCheck(this,e),this.items=t,this.keyFn="function"==typeof n?n:function(e){return e[n]},this.templateFn=o,this.keys=[],this.htmlTemplates={},this._init()}return _createClass(e,[{key:"_init",value:function(){var e=this;this.items.forEach(function(t,n,o){var r=e.keyFn.apply(e,[t]),a=e.templateFn.apply(e,[t,n,o]);e.htmlTemplates[r]=a,e.keys.push(r)})}},{key:"destroy",value:function(){var e=this;this.keys.forEach(function(t){e.htmlTemplates[t]instanceof HtmlTemplate&&(e.htmlTemplates[t].destroy(),e.placeHolders[t].parentNode.removeChild(e.placeHolders[t]))}),this.keys=[],this.htmlTemplates={},this.items={},delete this.placeHolders}}]),e}(),HtmlTemplate=function(){function e(t,n){_classCallCheck(this,e),this.strings=t,this.values=n,this.key=this.strings.join("").replace(/\s/g,"")}return _createClass(e,[{key:"generateNodeTree",value:function(){var e=this.key;if(!(e in _cache)){var t=document.createElement("template");t.innerHTML=this.strings.join(PLACEHOLDER),_cache[e]=t}return this.content=_cache[e].content.cloneNode(!0),_cache[e].dynamicNodesPath?(this.dynamicNodesPath=_cache[e].dynamicNodesPath,this._warmStart()):(this._init(),_cache[e].dynamicNodesPath=this.dynamicNodesPath),this.nodeTree=Array.from(this.content.childNodes),this.nodeTree}},{key:"_init",value:function(){var e=[],t=[];this._lookDynamicNodes(Array.from(this.content.childNodes),e,t),this.dynamicNodes=e,this.dynamicNodesPath=t.map(function(e){return e.reverse()}),this.applyValues(this.values)}},{key:"_warmStart",value:function(){this._lookDynamicNodesFromPath(),this.applyValues(this.values)}},{key:"_lookDynamicNodesFromPath",value:function(){var e=this,t=this.dynamicNodesPath.map(function(t){return t.reduce(function(e,t){if("number"==typeof t)return e.childNodes[t];var n=e.attributes[t.name];return n.$dynamicAttributeLength=t.dynamicLength,n.$dynamicAttributeLengthPos=0,n},e.content)});this.dynamicNodes=t}},{key:"_lookDynamicNodes",value:function(e,t,n){var o=this;e.forEach(function(e){e instanceof Comment&&e.nodeValue==PLACEHOLDER_CONTENT?(t.push(e),n.push(getPath(e))):e.attributes&&(Array.from(e.attributes).reduce(function(e,t){if(t.nodeValue.indexOf(PLACEHOLDER)>=0)for(var o=t.nodeValue.split(PLACEHOLDER).length-1,r=0;r<o;r++){t.$dynamicAttributeLength=o,t.$dynamicAttributeLengthPos=0,e.push(t);var a=[{name:t.nodeName,dynamicLength:o}].concat(getPath(t.ownerElement));n.push(a)}return e},t),o._lookDynamicNodes(Array.from(e.childNodes),t,n))})}},{key:"applyValues",value:function(t){this.dynamicNodes.forEach(function(n,o){n.nodeType===Node.ATTRIBUTE_NODE?e._applyAttributeNode(n,t[o]):_render(t[o],n)})}},{key:"destroy",value:function(){this.nodeTree.forEach(function(e){return e.parentNode.removeChild(e)}),this.content=null}}],[{key:"_applyAttributeNode",value:function(e,t){"function"==typeof t&&0===e.name.indexOf("on")?(e.nodeValue=PLACEHOLDER_CONTENT,e.ownerElement[e.name]=t):(e.$valueOriginal||(e.$valueOriginal=e.value),e.$dynamicAttributeLengthPos==e.$dynamicAttributeLength&&(e.$dynamicAttributeLengthPos=0),0==e.$dynamicAttributeLengthPos&&(e.$value=e.$valueOriginal),isMinimizationAttribute(e)?e.ownerElement[e.nodeName]=t:(e.$value=e.$value.split(PLACEHOLDER).reduce(function(e,n,o){return 0==o?n:""+e+(1==o?t:PLACEHOLDER)+n},""),++e.$dynamicAttributeLengthPos==e.$dynamicAttributeLength&&e.value!=e.$value&&(e.value=e.$value)))}}]),e}();